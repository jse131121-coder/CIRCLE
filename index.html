<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>CIRCLE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

<style>
*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif}
body{margin:0;background:#fff}

/* Splash */
#splash{
position:fixed;inset:0;background:white;display:flex;
align-items:center;justify-content:center;font-size:32px;font-weight:700;
z-index:30
}

/* LOGIN */
#login{
position:fixed;inset:0;background:white;display:flex;
flex-direction:column;align-items:center;justify-content:center;z-index:20
}
#login input{padding:12px;border-radius:14px;border:1px solid #ddd;width:240px;margin-top:10px}
#login button{margin-top:12px;padding:12px 22px;border-radius:16px;border:none;background:black;color:white}

/* HEADER */
header{text-align:center;padding:14px;font-weight:700;border-bottom:1px solid #eee}

/* STORY */
#storyBar{display:flex;gap:10px;padding:10px;overflow-x:auto}
.story{
width:60px;height:60px;border-radius:50%;
background:linear-gradient(45deg,#ff9acb,#ffd1e6);
display:flex;align-items:center;justify-content:center;color:white;font-weight:700
}

/* FEED */
#feed{padding-bottom:110px}
.post{
background:#ffd6e5;margin:12px;border-radius:22px;padding:14px;
animation:slide .3s ease
}
@keyframes slide{
from{transform:translateY(10px);opacity:.5}
to{transform:translateY(0);opacity:1}
}
.actions button{border:none;background:none}

/* CHAT */
#chat{display:none;padding-bottom:100px}
.msg{
max-width:70%;padding:10px;border-radius:16px;margin:6px;font-size:14px
}
.me{background:#ffc1d6}
.other{background:#f2f2f2;align-self:flex-end}
.time{font-size:10px;color:#666}

/* CHAT INPUT */
#chatInput{
position:fixed;bottom:60px;width:100%;display:none;
padding:6px;background:white
}
#chatInput input{flex:1;padding:10px;border-radius:14px;border:1px solid #ddd}
#chatInput button{border:none;background:#ff9acb;color:white;border-radius:14px;padding:10px;margin-left:5px}

/* LIVE */
#live{display:none;position:relative}
#live video{width:100%;height:100vh;object-fit:cover}
#heartBtn{
position:absolute;right:15px;bottom:100px;font-size:28px;border:none;background:none
}
.heart{
position:absolute;bottom:120px;right:20px;font-size:24px;
animation:float 2s forwards
}
@keyframes float{
from{transform:translateY(0);opacity:1}
to{transform:translateY(-200px);opacity:0}
}

/* PROFILE */
#profile{display:none;padding:20px}

/* NAV */
nav{
position:fixed;bottom:0;width:100%;background:white;
display:flex;justify-content:space-around;padding:10px;border-top:1px solid #eee
}
nav button{background:none;border:none;font-size:16px}
</style>
</head>

<body>

<div id="splash">CIRCLE</div>

<!-- LOGIN -->
<div id="login">
<h2>CIRCLE</h2>
<input id="nameInput" placeholder="ÎãâÎÑ§ÏûÑ">
<input type="file" id="photoInput">
<button id="enterBtn">ENTER</button>
</div>

<header>CIRCLE</header>

<div id="storyBar">
<div class="story">+</div>
</div>

<div id="feed"></div>

<div id="chat">
<div id="chatBox"></div>
</div>

<div id="chatInput">
<input id="msgInput" placeholder="Î©îÏãúÏßÄ ÏûÖÎ†•">
<button onclick="sendMsg()">Ï†ÑÏÜ°</button>
</div>

<div id="live">
<video id="cam" autoplay playsinline></video>
<button id="heartBtn" onclick="spawnHeart()">‚ù§Ô∏è</button>
</div>

<div id="profile">
<h3>Profile</h3>
<img id="profileImg" width="120" style="border-radius:50%">
<br><br>
<input id="newName" placeholder="ÎãâÎÑ§ÏûÑ Î≥ÄÍ≤Ω">
<input type="file" id="newPhoto">
<br><br>
<button onclick="saveProfile()">Ï†ÄÏû•</button>
<button onclick="logout()">Î°úÍ∑∏ÏïÑÏõÉ</button>
</div>

<nav>
<button onclick="showFeed()">üè†</button>
<button onclick="showChat()">üí¨</button>
<button onclick="createPost()">‚ûï</button>
<button onclick="showLive()">üî¥</button>
<button onclick="showProfile()">üë§</button>
</nav>

<script>
const splash=document.getElementById("splash")
setTimeout(()=>{splash.style.display="none"},1000)

let user=JSON.parse(localStorage.getItem("circleUser"))
let posts=JSON.parse(localStorage.getItem("circlePosts"))||[]
let chats=JSON.parse(localStorage.getItem("circleChats"))||[]

const loginBox=document.getElementById("login")
const feed=document.getElementById("feed")

if(user){
loginBox.style.display="none"
showFeed()
loadFeed()
}

/* LOGIN FIX */
document.getElementById("enterBtn").onclick=function(){
let name=nameInput.value.trim()
if(!name){
alert("ÎãâÎÑ§ÏûÑ ÏûÖÎ†•Ìï¥Ï§ò")
return
}

let file=photoInput.files[0]

if(file){
let r=new FileReader()
r.onload=function(){
saveUser(name,r.result)
}
r.readAsDataURL(file)
}else{
saveUser(name,"")
}
}

function saveUser(name,photo){
user={name,photo}
localStorage.setItem("circleUser",JSON.stringify(user))
loginBox.style.display="none"
showFeed()
loadFeed()
}

/* FEED */
function loadFeed(){
feed.innerHTML=""
posts.forEach((p,i)=>{
feed.innerHTML+=`
<div class="post">
<b>${p.name}</b><br>${p.text}
<div class="actions">
<button onclick="like(${i})">‚ù§Ô∏è ${p.like||0}</button>
<button onclick="editPost(${i})">‚úèÔ∏è</button>
<button onclick="delPost(${i})">üóë</button>
</div>
</div>`
})
}

/* POST */
function createPost(){
let text=prompt("Í∏Ä ÎÇ¥Ïö©")
if(!text)return
posts.unshift({name:user.name,text,like:0})
savePost()
}

function editPost(i){
let t=prompt("ÏàòÏ†ï",posts[i].text)
if(t){posts[i].text=t;savePost()}
}

function delPost(i){
if(confirm("ÏÇ≠Ï†ú?")){posts.splice(i,1);savePost()}
}

function like(i){
posts[i].like++
savePost()
}

function savePost(){
localStorage.setItem("circlePosts",JSON.stringify(posts))
loadFeed()
}

/* CHAT */
function showChat(){
hideAll()
chat.style.display="block"
chatInput.style.display="flex"
loadChat()
}

function loadChat(){
chatBox.innerHTML=""
chats.forEach(c=>{
chatBox.innerHTML+=`
<div class="msg ${c.me?'me':'other'}">
${c.text}
<div class="time">${c.time}</div>
</div>`
})
}

function sendMsg(){
let text=msgInput.value.trim()
if(!text)return
let time=new Date().toLocaleTimeString()
chats.push({text,me:true,time})
localStorage.setItem("circleChats",JSON.stringify(chats))
msgInput.value=""
loadChat()
}

/* LIVE */
let stream
function showLive(){
hideAll()
live.style.display="block"
navigator.mediaDevices.getUserMedia({video:true}).then(s=>{
stream=s
cam.srcObject=s
})
}

function spawnHeart(){
let h=document.createElement("div")
h.className="heart"
h.innerText="‚ù§Ô∏è"
live.appendChild(h)
setTimeout(()=>h.remove(),2000)
}

/* PROFILE */
function showProfile(){
hideAll()
profile.style.display="block"
profileImg.src=user.photo
}

function saveProfile(){
let name=newName.value.trim()
let file=newPhoto.files[0]

if(file){
let r=new FileReader()
r.onload=function(){
user.photo=r.result
user.name=name||user.name
finishProfileSave()
}
r.readAsDataURL(file)
}else{
user.name=name||user.name
finishProfileSave()
}
}

function finishProfileSave(){
localStorage.setItem("circleUser",JSON.stringify(user))
alert("Ï†ÄÏû• ÏôÑÎ£å")
}

/* HOME */
function showFeed(){
hideAll()
feed.style.display="block"
}

/* UTIL */
function hideAll(){
feed.style.display="none"
chat.style.display="none"
profile.style.display="none"
live.style.display="none"
chatInput.style.display="none"
}

function logout(){
localStorage.clear()
location.reload()
}
</script>

</body>
</html>



