<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AOUSE</title>
<style>
*{box-sizing:border-box;font-family:Arial, sans-serif}
body{margin:0;background:#f5f7fb}
header{display:flex;justify-content:space-between;align-items:center;padding:14px 20px;background:white;border-bottom:1px solid #eee}
.logo{font-weight:800;font-size:22px}
.btn{padding:8px 14px;border-radius:14px;border:none;background:#222;color:white;cursor:pointer}
.container{max-width:900px;margin:20px auto;padding:10px}
.card{background:white;border-radius:18px;padding:16px;margin-bottom:12px;box-shadow:0 5px 10px rgba(0,0,0,.05)}
.post-item{display:flex;justify-content:space-between;align-items:center;cursor:pointer}
.post-title{font-weight:700;font-size:18px}
.badge{display:inline-block;padding:3px 8px;border-radius:10px;font-size:11px;color:white;background:#3b82f6;margin-left:5px}
.pinned{color:#f59e0b;margin-right:6px}
.modal-bg{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.3);display:none;align-items:center;justify-content:center;z-index:100}
.modal{background:white;border-radius:20px;padding:20px;width:320px}
.modal h2{margin-top:0}
.input{width:100%;padding:10px;border-radius:10px;border:1px solid #ddd;margin-bottom:10px}
.flex{display:flex;gap:8px}
.comment{margin-top:10px;padding-left:10px;border-left:2px solid #eee}
</style>
</head>
<body>

<header>
<div class="logo">AOUSE</div>
<div>
<button id="writeBtn" class="btn" style="display:none">Í∏ÄÏì∞Í∏∞</button>
<button id="loginBtn" class="btn">ARRIVE</button>
</div>
</header>

<div class="container" id="postList"></div>

<!-- LOGIN MODAL -->
<div class="modal-bg" id="loginModal">
<div class="modal">
<h2>ARRIVE</h2>
<input class="input" id="loginId" placeholder="ALLOW">
<input class="input" id="loginPw" type="password" placeholder="ACODE">
<div class="flex">
<button class="btn" id="loginClose">BACK</button>
<button class="btn" id="loginGo">GO</button>
</div>
</div>
</div>

<!-- WRITE MODAL -->
<div class="modal-bg" id="writeModal">
<div class="modal">
<h2>Í∏ÄÏì∞Í∏∞</h2>
<input class="input" id="postTitle" placeholder="Ï†úÎ™©">
<textarea class="input" id="postContent" placeholder="ÎÇ¥Ïö©"></textarea>
<input class="input" type="file" id="postImage">
<label><input type="checkbox" id="postPinned"> pinned</label>
<div class="flex">
<button class="btn" id="writeCancel">Ï∑®ÏÜå</button>
<button class="btn" id="writeSubmit">Îì±Î°ù</button>
</div>
</div>
</div>

<!-- VIEW MODAL -->
<div class="modal-bg" id="viewModal">
<div class="modal" style="width:90%;max-width:500px">
<div id="viewContent"></div>
<hr>
<input class="input" id="commentInput" placeholder="ÎåìÍ∏Ä ÏûëÏÑ±">
<button class="btn" id="commentSubmit">ÎåìÍ∏Ä Îì±Î°ù</button>
<div id="commentList"></div>
<button class="btn" id="viewClose" style="margin-top:10px">Îã´Í∏∞</button>
</div>
</div>

<script>
let posts = JSON.parse(localStorage.getItem('aouse_posts')) || [];
let user = JSON.parse(localStorage.getItem('aouse_user')) || null;
let currentPost = null;
let editMode = false;

if(posts.length === 0){
 const demo={
  id:Date.now(),
  title:"!!AOUSE Ïù¥Ïö© ÏïàÎÇ¥!!",
  content:"ÏïàÎÖïÌïòÏÑ∏Ïöî! AOUSE Ïª§ÎÆ§ÎãàÌã∞ÏûÖÎãàÎã§.\nÏûêÏú†Î°≠Í≤å Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî!",
  image:null,
  pinned:true,
  author:"ARCEN",
  badge:true,
  date:new Date().toLocaleString(),
  comments:[]
 }
 posts.push(demo);
 save();
}

function save(){
 localStorage.setItem('aouse_posts',JSON.stringify(posts));
}

function render(){
 const list=document.getElementById('postList');
 list.innerHTML='';
 const sorted=[...posts].sort((a,b)=>b.pinned-a.pinned);
 sorted.forEach(p=>{
  const div=document.createElement('div');
  div.className='card post-item';
  div.innerHTML=`<div><span class='pinned'>${p.pinned?'üìå':''}</span><span class='post-title'>${p.title}</span></div><div>${p.author}${p.badge?'<span class="badge">‚úî</span>':''}</div>`;
  div.addEventListener('click',()=>openPost(p.id));
  list.appendChild(div);
 });
}

function openPost(id){
 currentPost=posts.find(p=>p.id===id);
 document.getElementById('viewModal').style.display='flex';

 const controls=(user && user.id===currentPost.author)
 ? `<div style="margin-top:10px"><button class='btn' onclick='editPost()'>ÏàòÏ†ï</button> <button class='btn' onclick='deletePost()'>ÏÇ≠Ï†ú</button></div>`
 : '';

 document.getElementById('viewContent').innerHTML=`<b>${currentPost.title}</b><br><small>${currentPost.author} ¬∑ ${currentPost.date}</small><p>${currentPost.content.replace(/\n/g,'<br>')}</p>${currentPost.image?'<img src="'+currentPost.image+'" width="100%">':''}${controls}`;
 renderComments();
}

function renderComments(){
 const c=document.getElementById('commentList');
 c.innerHTML='';
 currentPost.comments.forEach(cm=>{
  const d=document.createElement('div');
  d.className='comment';
  d.innerHTML=`<b>${cm.author}</b><br>${cm.text.replace(/\n/g,'<br>')}`;
  c.appendChild(d);
 });
}

function addComment(){
 if(!user){alert('Î°úÍ∑∏Ïù∏ ÌïÑÏöî');return}
 const txt=document.getElementById('commentInput').value;
 if(!txt) return;
 currentPost.comments.push({author:user.id,text:txt});
 save();
 document.getElementById('commentInput').value='';
 renderComments();
}

function login(){
 const id=document.getElementById('loginId').value.trim();
 const pw=document.getElementById('loginPw').value.trim();
 if(!id||!pw){alert('Ï†ïÎ≥¥ ÏûÖÎ†•');return}
 user={id};
 localStorage.setItem('aouse_user',JSON.stringify(user));
 document.getElementById('loginModal').style.display='none';
 document.getElementById('writeBtn').style.display='inline-block';
}

function submitPost(){
 if(!user){alert('Î°úÍ∑∏Ïù∏ ÌïÑÏöî');return}
 const t=document.getElementById('postTitle').value;
 const c=document.getElementById('postContent').value;
 const pin=document.getElementById('postPinned').checked;
 const img=document.getElementById('postImage').files[0];
 if(!t||!c) return;

 const reader=new FileReader();
 reader.onload=function(){
  if(editMode){
   currentPost.title=t;
   currentPost.content=c;
   currentPost.pinned=pin;
   if(img) currentPost.image=reader.result;
   editMode=false;
  } else {
   posts.push({
    id:Date.now(),title:t,content:c,image:img?reader.result:null,pinned:pin,author:user.id,badge:false,date:new Date().toLocaleString(),comments:[]
   });
  }
  save();
  closeWrite();
  render();
 }
 if(img) reader.readAsDataURL(img); else reader.onload();
}

function editPost(){
 editMode=true;
 document.getElementById('viewModal').style.display='none';
 document.getElementById('writeModal').style.display='flex';
 document.getElementById('postTitle').value=currentPost.title;
 document.getElementById('postContent').value=currentPost.content;
 document.getElementById('postPinned').checked=currentPost.pinned;
}

function deletePost(){
 if(!confirm('ÏÇ≠Ï†úÌï†ÍπåÏöî?')) return;
 posts=posts.filter(p=>p.id!==currentPost.id);
 save();
 document.getElementById('viewModal').style.display='none';
 render();
}

function closeWrite(){
 document.getElementById('writeModal').style.display='none';
 document.getElementById('postTitle').value='';
 document.getElementById('postContent').value='';
 document.getElementById('postPinned').checked=false;
 editMode=false;
}

// EVENT BINDING
document.getElementById('loginBtn').onclick=()=>document.getElementById('loginModal').style.display='flex';
document.getElementById('loginClose').onclick=()=>document.getElementById('loginModal').style.display='none';
document.getElementById('loginGo').onclick=login;
document.getElementById('writeBtn').onclick=()=>document.getElementById('writeModal').style.display='flex';
document.getElementById('writeCancel').onclick=closeWrite;
document.getElementById('writeSubmit').onclick=submitPost;
document.getElementById('commentSubmit').onclick=addComment;
document.getElementById('viewClose').onclick=()=>document.getElementById('viewModal').style.display='none';

if(user){document.getElementById('writeBtn').style.display='inline-block'}
render();
</script>

</body>
</html>



