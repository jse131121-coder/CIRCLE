<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>CIRCLE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
*{box-sizing:border-box;font-family:system-ui, -apple-system, BlinkMacSystemFont, sans-serif}
body{margin:0;background:#f5f6f8}
header{background:#fff;padding:14px 18px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #e6e6e6}
.logo{font-weight:900;letter-spacing:1px}
.btn{border:none;border-radius:20px;padding:8px 16px;cursor:pointer}
.arrive{background:#111;color:#fff}
.container{max-width:760px;margin:20px auto;padding:0 14px}
.card{background:#fff;border-radius:14px;padding:16px;margin-bottom:14px;box-shadow:0 6px 14px rgba(0,0,0,.04)}
.flex{display:flex;align-items:center;gap:10px}
.avatar{width:38px;height:38px;border-radius:50%;background:#ddd;object-fit:cover}
.badge{font-size:12px;background:#e9f1ff;color:#2563eb;padding:2px 6px;border-radius:6px}
.pinned{background:#fff3cd;color:#9a6700;font-size:12px;padding:4px 8px;border-radius:12px;margin-left:auto}
.post-title{font-weight:800;letter-spacing:3px}
.post-meta{font-size:12px;color:#777;margin-top:4px}
.post-content{margin-top:12px;line-height:1.5}
.comment-box{margin-top:12px;padding-top:12px;border-top:1px solid #eee}
.comment{font-size:14px;margin-top:8px}
.reply{margin-left:22px;color:#444}
.write-box textarea{width:100%;border-radius:10px;border:1px solid #ddd;padding:10px;resize:none}
.write-actions{display:flex;justify-content:space-between;margin-top:8px}
input[type="text"]{padding:6px;border-radius:8px;border:1px solid #ddd;width:100%}
small{color:#999}
</style>
</head>
<body>
<header>
  <div class="logo">CIRCLE</div>
  <button class="btn arrive" onclick="login()">ARRIVE</button>
</header>

<div class="container">

<!-- Í∏ÄÏì∞Í∏∞ -->
<div class="card write-box">
  <div class="flex">
    <img id="myAvatar" class="avatar" />
    <strong id="myName">Guest</strong>
    <span id="myBadge" class="badge">USER</span>
  </div>
  <textarea id="postText" rows="3" placeholder="Î¨¥Ïä® Ïù¥ÏïºÍ∏∞Î•º ÎÇòÎàÑÍ≥† Ïã∂Ïñ¥?"></textarea>
  <input id="imageLink" type="text" placeholder="Ïù¥ÎØ∏ÏßÄ ÎßÅÌÅ¨ (ÏÑ†ÌÉù)" />
  <div class="write-actions">
    <label><input type="checkbox" id="pinCheck" /> Í≥†Ï†ï</label>
    <button class="btn arrive" onclick="addPost()">Í≤åÏãú</button>
  </div>
</div>

<!-- Í≤åÏãúÍ∏Ä ÏòÅÏó≠ -->
<div id="postList"></div>

</div>

<script>
let user = JSON.parse(localStorage.getItem('circleUser')) || null;
let posts = JSON.parse(localStorage.getItem('circlePosts')) || [];

function login(){
  const name = prompt('Ïù¥Î¶Ñ ÏûÖÎ†•');
  if(!name) return;
  const avatar = prompt('ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ URL (ÏóÜÏúºÎ©¥ ÎπÑÏõåÎëêÍ∏∞)') || '';
  const badge = prompt('Î±ÉÏßÄ Ïù¥Î¶Ñ (Ïòà: official, creator, staff)') || 'USER';
  user = {name, avatar, badge};
  localStorage.setItem('circleUser', JSON.stringify(user));
  loadUser();
}

function loadUser(){
  if(!user){
    document.getElementById('myName').innerText = 'Guest';
    return;
  }
  document.getElementById('myName').innerText = user.name;
  document.getElementById('myBadge').innerText = user.badge;
  document.getElementById('myAvatar').src = user.avatar || 'https://i.imgur.com/4M34hi2.png';
}

function addPost(){
  if(!user){alert('Î°úÍ∑∏Ïù∏ Î®ºÏ†Ä!');return;}
  const text = postText.value.trim();
  if(!text){alert('ÎÇ¥Ïö© ÏûÖÎ†•');return;}
  const img = imageLink.value;
  const pinned = pinCheck.checked;

  const post = {
    id: Date.now(),
    author: user,
    text,
    img,
    pinned,
    time: new Date().toLocaleString(),
    comments: []
  };

  posts.unshift(post);
  save();
  render();
  postText.value='';
  imageLink.value='';
  pinCheck.checked=false;
}

function addComment(postId){
  const input = document.getElementById('c_'+postId);
  const text = input.value.trim();
  if(!text) return;

  const post = posts.find(p=>p.id===postId);
  post.comments.push({
    name:user.name,
    text,
    time:new Date().toLocaleDateString()
  });
  save();
  render();
}

function save(){
  localStorage.setItem('circlePosts', JSON.stringify(posts));
}

function render(){
  const list = document.getElementById('postList');
  list.innerHTML='';

  const sorted = [...posts].sort((a,b)=>b.pinned - a.pinned);

  sorted.forEach(p=>{
    const el = document.createElement('div');
    el.className='card';

    el.innerHTML = `
      <div class="flex">
        <img class="avatar" src="${p.author.avatar || 'https://i.imgur.com/4M34hi2.png'}" />
        <div>
          <div class="post-title">${p.author.name}</div>
          <div class="post-meta">${p.author.badge} ¬∑ ${p.time}</div>
        </div>
        ${p.pinned?'<span class="pinned">üìå PINNED</span>':''}
      </div>

      <div class="post-content">${p.text.replace(/\n/g,'<br>')}</div>
      ${p.img?`<img src="${p.img}" style="width:100%;margin-top:10px;border-radius:10px">`:''}

      <div class="comment-box">
        <strong>ÎåìÍ∏Ä</strong>
        ${p.comments.map(c=>`<div class="comment">${c.name} ¬∑ ${c.time}<br>${c.text}</div>`).join('')}
        <div style="display:flex;gap:6px;margin-top:8px">
          <input id="c_${p.id}" type="text" placeholder="ÎåìÍ∏Ä ÏûÖÎ†•">
          <button class="btn" onclick="addComment(${p.id})">Îì±Î°ù</button>
        </div>
      </div>
    `;

    list.appendChild(el);
  })
}

loadUser();
render();
</script>
</body>
</html>
