<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>CIRCLE</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif}
body{margin:0;background:#fff}

/* LOGIN */
#login{
position:fixed;inset:0;background:white;
display:flex;flex-direction:column;
align-items:center;justify-content:center;z-index:10
}
#login input{padding:12px;border-radius:12px;border:1px solid #ddd;width:240px;margin:6px}
#login button{padding:12px 22px;border:none;border-radius:14px;background:black;color:white}

/* HEADER */
header{text-align:center;padding:14px;font-weight:700;border-bottom:1px solid #eee}

/* COMMUNITY */
#feed{padding-bottom:120px}
.post{
background:#ffd6e5;
margin:12px;
padding:14px;
border-radius:20px
}
.post-header{display:flex;align-items:center;gap:8px}
.post-header img{width:34px;height:34px;border-radius:50%}
.actions button{border:none;background:none;margin-right:8px}

.comment-box{
margin-top:10px;
background:white;
border-radius:14px;
padding:8px
}
.comment{
font-size:13px;
margin-bottom:6px
}
.comment-input{
display:flex;
gap:6px
}
.comment-input textarea{
flex:1;
border-radius:10px;
border:1px solid #ddd;
padding:6px;
resize:none
}

/* POST MODAL */
#postModal{
position:fixed;inset:0;
background:rgba(0,0,0,.4);
display:none;
align-items:center;
justify-content:center;
z-index:20
}
#postBox{
background:white;
padding:20px;
border-radius:20px;
width:90%
}
#postBox textarea{
width:100%;
height:100px;
resize:none;
border-radius:12px;
padding:10px
}

/* CHAT */
#chat{display:none;padding-bottom:110px}
.chatMsg{
display:flex;
align-items:flex-start;
gap:8px;
margin:10px
}
.chatMsg img{width:34px;height:34px;border-radius:50%}
.bubble{
background:#ffc1d6;
padding:10px;
border-radius:14px;
max-width:70%
}
.time{font-size:10px;color:#666;margin-top:4px}

#chatInput{
position:fixed;
bottom:60px;
width:100%;
display:none;
padding:8px;
background:white
}
#chatInput textarea{
flex:1;
border-radius:12px;
padding:8px;
border:1px solid #ddd;
resize:none
}
#chatInput button{
margin-left:6px;
border:none;
background:#ff9acb;
color:white;
border-radius:12px;
padding:10px
}

/* PROFILE */
#profile{display:none;padding:20px}

/* NAV */
nav{
position:fixed;
bottom:0;
width:100%;
background:white;
display:flex;
justify-content:space-around;
padding:10px;
border-top:1px solid #eee
}
nav button{border:none;background:none;font-size:16px}

</style>
</head>

<body>

<!-- LOGIN -->
<div id="login">
<h2>CIRCLE</h2>
<input id="nameInput" placeholder="ÎãâÎÑ§ÏûÑ">
<input type="file" id="photoInput">
<button onclick="login()">ENTER</button>
</div>

<header>CIRCLE</header>

<!-- COMMUNITY -->
<div id="feed"></div>

<!-- CHAT -->
<div id="chat"></div>

<div id="chatInput">
<textarea id="msgInput" placeholder="Î©îÏãúÏßÄ ÏûÖÎ†•"></textarea>
<button onclick="sendMsg()">Ï†ÑÏÜ°</button>
</div>

<!-- PROFILE -->
<div id="profile">
<h3>ÌîÑÎ°úÌïÑ ÏÑ§Ï†ï</h3>
<img id="profileImg" width="120" style="border-radius:50%">
<br><br>
<input id="newName" placeholder="ÎãâÎÑ§ÏûÑ Î≥ÄÍ≤Ω">
<input type="file" id="newPhoto">
<br><br>
<button onclick="saveProfile()">Ï†ÄÏû•</button>
<button onclick="logout()">Î°úÍ∑∏ÏïÑÏõÉ</button>
</div>

<!-- POST MODAL -->
<div id="postModal">
<div id="postBox">
<h3>Í∏Ä ÏûëÏÑ±</h3>
<textarea id="postText" placeholder="ÎÇ¥Ïö© ÏûÖÎ†•"></textarea>
<br><br>
<button onclick="uploadPost()">Ïò¨Î¶¨Í∏∞</button>
<button onclick="closePost()">Îã´Í∏∞</button>
</div>
</div>

<!-- NAV -->
<nav>
<button onclick="showFeed()">üè†</button>
<button onclick="showChat()">üí¨</button>
<button onclick="openPost()">‚ûï</button>
<button onclick="showProfile()">üë§</button>
</nav>

<script>
let user = JSON.parse(localStorage.getItem("circleUser"))
let posts = JSON.parse(localStorage.getItem("circlePosts")) || []
let chats = JSON.parse(localStorage.getItem("circleChats")) || []

if(user){
login.style.display="none"
loadFeed()
}

/* LOGIN */
function login(){
let name=nameInput.value.trim()
if(!name){alert("ÎãâÎÑ§ÏûÑ ÏûÖÎ†•");return}

let file=photoInput.files[0]

if(file){
let r=new FileReader()
r.onload=()=>{
saveUser(name,r.result)
}
r.readAsDataURL(file)
}else{
saveUser(name,"")
}
}

function saveUser(name,photo){
user={name,photo}
localStorage.setItem("circleUser",JSON.stringify(user))
login.style.display="none"
loadFeed()
}

/* COMMUNITY */
function loadFeed(){
feed.innerHTML=""
posts.forEach((p,i)=>{
feed.innerHTML+=`
<div class="post">
<div class="post-header">
<img src="${p.photo||''}">
<b>${p.name}</b>
</div>
<div style="white-space:pre-wrap">${p.text}</div>

<div class="actions">
<button onclick="like(${i})">‚ù§Ô∏è ${p.like||0}</button>
<button onclick="delPost(${i})">üóë</button>
</div>

<div class="comment-box">
${(p.comments||[]).map(c=>`<div class="comment"><b>${c.name}</b>: ${c.text}</div>`).join("")}
<div class="comment-input">
<textarea id="c${i}" placeholder="ÎåìÍ∏Ä"></textarea>
<button onclick="addComment(${i})">Î≥¥ÎÇ¥Í∏∞</button>
</div>
</div>

</div>
`
})
}

function openPost(){postModal.style.display="flex"}
function closePost(){postModal.style.display="none"}

function uploadPost(){
let text=postText.value.trim()
if(!text)return

posts.unshift({
name:user.name,
photo:user.photo,
text:text,
like:0,
comments:[]
})

localStorage.setItem("circlePosts",JSON.stringify(posts))
postText.value=""
closePost()
loadFeed()
}

function like(i){
posts[i].like++
savePosts()
}

function delPost(i){
if(confirm("ÏÇ≠Ï†ú?")){
posts.splice(i,1)
savePosts()
}
}

function addComment(i){
let input=document.getElementById("c"+i)
let text=input.value.trim()
if(!text)return

posts[i].comments.push({
name:user.name,
text:text
})

savePosts()
}

function savePosts(){
localStorage.setItem("circlePosts",JSON.stringify(posts))
loadFeed()
}

/* CHAT */
function showChat(){
hideAll()
chat.style.display="block"
chatInput.style.display="flex"
loadChat()
}

function loadChat(){
chat.innerHTML=""
chats.forEach(c=>{
chat.innerHTML+=`
<div class="chatMsg">
<img src="${c.photo}">
<div>
<b>${c.name}</b>
<div class="bubble" style="white-space:pre-wrap">${c.text}</div>
<div class="time">${c.time}</div>
</div>
</div>
`
})
}

function sendMsg(){
let text=msgInput.value.trim()
if(!text)return

let time=new Date().toLocaleTimeString()

chats.push({
name:user.name,
photo:user.photo,
text:text,
time:time
})

localStorage.setItem("circleChats",JSON.stringify(chats))
msgInput.value=""
loadChat()
}

/* PROFILE */
function showProfile(){
hideAll()
profile.style.display="block"
profileImg.src=user.photo
}

function saveProfile(){
let name=newName.value.trim()
let file=newPhoto.files[0]

if(file){
let r=new FileReader()
r.onload=()=>{
user.photo=r.result
user.name=name||user.name
finishProfile()
}
r.readAsDataURL(file)
}else{
user.name=name||user.name
finishProfile()
}
}

function finishProfile(){
localStorage.setItem("circleUser",JSON.stringify(user))
alert("Ï†ÄÏû• ÏôÑÎ£å")
}

/* NAV */
function showFeed(){
hideAll()
feed.style.display="block"
}

function hideAll(){
feed.style.display="none"
chat.style.display="none"
profile.style.display="none"
chatInput.style.display="none"
}

/* LOGOUT */
function logout(){
localStorage.clear()
location.reload()
}
</script>

</body>
</html>



